name: Test Data Collection Workflow

on:
  workflow_dispatch:
    inputs:
      podcast_mode:
        description: 'æ’­å®¢æ¨¡å¼ (tw/us)'
        required: true
        default: 'tw'
        type: choice
        options:
          - tw
          - us
      simulate_time:
        description: 'æ¨¡æ“¬æ™‚é–“ (HH:MM CST, ä¾‹å¦‚ 06:00 æˆ– 14:00)'
        required: false
        default: '20:34'  # ç•¶å‰æ™‚é–“ç´„ 20:34 CST

jobs:
  data-collection:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          path: repo
      - name: Generate Mock Data
        working-directory: repo
        run: |
          echo "ğŸ“¥ é–‹å§‹ç”Ÿæˆæ¨¡æ“¬æ•¸æ“š - æ¨¡å¼: ${{ inputs.podcast_mode }}"
          mkdir -p data logs
          echo "date,close" > data/daily_${{ inputs.podcast_mode }}.csv
          for i in {0..9}; do
            echo "2024-01-0$i,100.$i" >> data/daily_${{ inputs.podcast_mode }}.csv
          done
          echo "âœ… æ•¸æ“šå·²ä¿å­˜åˆ°: data/daily_${{ inputs.podcast_mode }}.csv"
          echo "$(date): Data generation completed" > logs/data_collector.log
          echo "âœ… ç”Ÿæˆå®Œæˆï¼Œæª¢æŸ¥æª”æ¡ˆ: ls -la data/"
      - name: Check Output
        working-directory: repo
        run: |
          if [ -f "data/daily_${{ inputs.podcast_mode }}.csv" ]; then
            echo "âœ… æ•¸æ“šæ–‡ä»¶ç”ŸæˆæˆåŠŸ"
          else
            echo "âŒ æ•¸æ“šæ–‡ä»¶æœªç”Ÿæˆ"
            exit 1
          fi