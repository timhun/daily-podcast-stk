name: Test Data Collection Workflow

on:
  workflow_dispatch:
    inputs:
      podcast_mode:
        description: 'æ’­å®¢æ¨¡å¼ (tw/us)'
        required: true
        default: 'tw'
        type: choice
        options:
          - tw
          - us
      simulate_time:
        description: 'æ¨¡æ“¬æ™‚é–“ (HH:MM CST, ä¾‹å¦‚ 06:00 æˆ– 14:00)'
        required: false
        default: '20:51'  # ç•¶å‰æ™‚é–“ç´„ 20:51 CST

jobs:
  data-collection:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          path: repo
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - name: Install Dependencies
        working-directory: repo
        run: |
          pip install pandas
      - name: Run Data Collector
        working-directory: repo
        run: |
          echo "ğŸ“¥ é–‹å§‹åŸ·è¡Œè³‡æ–™æ”¶é›†å“¡ - æ¨¡å¼: ${{ inputs.podcast_mode }}"
          python scripts/data_collector.py
          echo "âœ… åŸ·è¡Œå®Œæˆï¼Œæª¢æŸ¥æª”æ¡ˆ: ls -la data/"
      - name: Check Output
        working-directory: repo
        run: |
          if [ -f "data/daily_${{ inputs.podcast_mode }}.csv" ]; then
            echo "âœ… æ•¸æ“šæ–‡ä»¶ç”ŸæˆæˆåŠŸ"
          else
            echo "âŒ æ•¸æ“šæ–‡ä»¶æœªç”Ÿæˆ"
            exit 1
          fi